@using System.Security.Claims
@inject NavigationManager Navigation
@inject AuthSettings AuthSettings

<AuthorizeView>
    <Authorized>
        <div class="d-flex align-items-center">
            @{
                var roles = context.User.Claims
                    .Where(c => c.Type == ClaimTypes.Role)
                    .Select(c => c.Value)
                    .ToList();
                var roleDisplay = roles.Count > 0 ? string.Join(", ", roles) : "User";
            }
            <div class="text-end me-3">
                <span class="text-light d-block">@context.User.Identity?.Name</span>
                <small class="text-light opacity-75">@roleDisplay</small>
            </div>
            @if (AuthSettings.DisableAuthentication)
            {
                <a href="login" class="btn btn-outline-light btn-sm">
                    <i class="bi bi-arrow-repeat me-1"></i>Switch User
                </a>
            }
            else
            {
                <a href="MicrosoftIdentity/Account/SignOut" class="btn btn-outline-light btn-sm">Sign out</a>
            }
        </div>
    </Authorized>
    <NotAuthorized>
        @if (AuthSettings.DisableAuthentication)
        {
            <a href="login" class="btn btn-outline-light btn-sm">Sign in</a>
        }
        else
        {
            <a href="MicrosoftIdentity/Account/SignIn" class="btn btn-outline-light btn-sm">Sign in</a>
        }
    </NotAuthorized>
</AuthorizeView>
